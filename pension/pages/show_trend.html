
<!DOCTYPE html>
<html class="h-100">
  <head>
    <title>Pension Angel</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="static/layout.css">
  </head>

  <body>

<!-- partial -->

<!-- partial:_navbar.html -->
<!--Navbar-->
<nav class="navbar" id="navb">
  <div class="container">
    
    <a class="navbar-brand" href="#"><strong>Pension Angel</strong></a>
    
    <button class="navbar-toggler btn btn-primary" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <i class="pa-icon-bars"></i>
    </button>

    <div class="collapse navbar-collapse">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="#">Dashboard</a>
          
          <div class="dropdown-menu">
            <a href="/pages/dashboard/performance.html">Latest Performance</a>
            <a href="/pages/dashboard/assessment.html">Latest Assessment</a>
            <a class="active" href="/pages/dashboard/improve.html">Better Performance</a>
            <a href="/pages/dashboard/risk_advice.html">Manage Risks</a>
            <a href="#">Update Account</a>
            <a href="#">Logout</a>
          </div>

        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Market Overview</a>
          <div class="dropdown-menu">
            <a href="/pages/show_trend.html">Overall Status</a>
            <a href="/pages/show_trends.html">Rising/Falling Trend</a>
          </div>         
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Help</a>
          <div class="dropdown-menu">
            <a href="/pages/help/benefits.html">Benefits For registered users</a>
            <a href="/pages/help/howtouse.html">How to use Pension Angel Tools</a>
            <a href="/pages/help/howpensionswork.html">How Defined Contribution pensions work</a>
            <a href="/pages/help/checkfunds.html">How to find which funds you own</a>
            <a href="/pages/help/makefunds.html">How to make your pension grow</a>
            <a href="pages/help/about.html">About</a>

          </div>          
        </li>
        <!-- example with user name in nav-->
<!--         <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="pa-icon-user"></i>
            &nbsp;&nbsp;<span>User Name</span>
          </a>
          <div class="dropdown-menu">
            <a href="#profile">Profile link</a>
          </div>
        </li> -->
        <!-- example with button in nav -->
        <li class="nav-item">
          <a class="btn btn-primary" href="/pages/login.html">Log In</a>
        </li> 
        <!--<li class="nav-item login">
          
          <span class="login-label"> Have an account? <a class="text-primary">Log in <i class="pa-icon-angle-down"></i></a></span>
          
          <div class="dropdown-menu">
            <span class="my-2">Have an account?</span>
            
            <input class="form-control mb-2" type="email" id="login_email" placeholder="Email" required/>
            <input class="form-control mb-2" type="password" id="login_password" placeholder="Password" required minlength="8" />
            
            <div class="flex align-items-center text-nowrap">
              <input type="checkbox" checked="checked" />
              <span>&nbsp;Remember me</span>
              <span class="mx-2">|</span>
              <span class="mr-2"><a class="text-primary " target="__blank">Forgot password?</a></span>    
            </div> 
           

            <button class="btn btn-primary" id="login">Log In</button>
            
            <hr />        
            <span class="mb-2">New to Pension Angel?</span>
            
            <a class="btn btn-default" href="#">Sign Up</a>
          
          </div>
        </li>-->
      </ul>
    </div>
  </div>
</nav>
<!--/.Navbar -->

<!-- partial -->

<main class="flex-shrink-0">
  <div class="bg-primary">
    <h1 class="container text-light text-center py-4">Pension Funds Performance</h1>
  </div>
   <div class="container">
    <div id="showTrend"></div>
  </div>
</main>
<!-- partial:_footer.html -->
<footer class="footer mt-auto">
  <div class="footer-main py-4">
    <div class="container">
      
      <div class="content">
        <div>
          <h5 class="text-light text-uppercase">Newsletter</h5>
          <p>Keep up on our always evolving product features and technology. Enter your e-mail and subscribe to our newsletter.</p>
        </div>
        <div>
          <h5 class="text-light text-uppercase">Latest Tweets</h5>
          <p>Please wait...</p>
        </div>
        <div>
          <h5 class="text-light text-uppercase">Contact Us</h5>
          <ul>
            <li>Address</li>
            <li>Phone: +3(324)234-2343</li>
            <li>Email: mail@example.com</li>
          </ul>
        </div>
      </div>
    </div>

  </div>

  <div class="footer-bottom py-4">
    <div class="container">
      <span class="footer-copyright">Â© Copyright The Pension Angel 2019</span>  
    </div>
  </div>

</footer>
<!-- <script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"></script> -->

<!-- <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>  -->

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<!--[if lt IE 9]>
<script src="https://code.highcharts.com/modules/oldie-polyfills.js"></script>
<![endif]-->  
<script src="https://code.highcharts.com/highcharts.js"></script>
<!--[if lt IE 9]>
<script src="https://code.highcharts.com/modules/oldie.js"></script>
<![endif]-->
<!-- <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script> -->
<!-- <script src="static/pensionangel.min.js"></script> -->
<script>
	

	document.addEventListener("DOMContentLoaded", function(event) {
		(function(){
		  
		  function Helpers(){
		  }

		  Helpers.prototype.extractFormFields = function(form){
		    var fields = {};

		    $(form).find('*[name]').each(function(i, el){
		      fields[$(el).attr('name')] = $(el).val() 
		    })
		    return fields;
		  }

		  Helpers.prototype.populateFormFields = function(form, data){
		    for (var key in data){
		      $(form).find('[name=' + key + ']').val(data[key]);
		    }
		  }

		  Helpers.prototype.isValidForm = function(form){
		    var isFormValid = true;

		    $(form).find('[required]').each(function(i, el){
		      if (!$(el).val()) isFormValid = false;
		    })
		    return isFormValid;
		  }


		  Helpers.prototype.customHeaders = function(metadata){
		    return {
		      title: {
		        text: metadata.caption
		      },
		      subtitle: {
		        text: metadata.subcaption
		      },
		      yAxis: {
		        title: {
		          text: metadata.y_axis_title
		        }
		      },
		      xAxis: {
		        title: {
		          text: metadata.x_axis_title
		        }
		      }
		    }    
		  }
		  
		  Helpers.prototype.derive = function(data){
		    if (data.data) data = data.data;

		    var dates = [];
		    for (var date in data){
		      dates.push(date);
		    }

		    var labels = [];
		    for (var label in data[dates[0]]){
		      labels.push(label);
		    }

		    var values = [];
		    for (var i in labels){
		      var label = labels[i];
		      var label_values = [];

		      for (var j in dates){
		        var date = dates[j];
		        label_values.push(data[date][label])
		      }
		      values.push(label_values.length == 1 ? label_values[0] : label_values);

		    }
		    return {
		      dates: dates,
		      labels: labels,
		      values: values      
		    };
		  }

		  window.Helpers = new Helpers()

		})();

		$('.navbar button.navbar-toggler').click(function(){
			$('.navbar .collapse').slideToggle(400);
			$('.dropdown-menu').slideUp(400);
		})

		$('.navbar .nav-item').click(function(event){
		  $(this).siblings().find('.dropdown-menu').slideUp(400);
		  $(this).find('.dropdown-menu').slideDown(400);
		})

		function ajax(url, callback){
			var xhr = new XMLHttpRequest();

			xhr.open('GET', url, true);

			xhr.send();
			xhr.onreadystatechange = function(){
				if (this.readyState == 4 && this.status == 200) {
			       callback(JSON.parse(xhr.responseText));
			    }
			}
		};
		ajax('https://api.pensionangel.com:5000/api/v1.0/show_trend', function(data) {
			// document.body.innerHTML = data.data['2020-03-06'][" of funds are worth more than a year ago"];
			// console.log(data)
			var derived = Helpers.derive(data);
						
			var series = derived.labels.map(function(label, idx){
			  return {
			    name: label,
			    color: label == ' of funds are worth more than a year ago' ? '#619445': '#C94545',
			    y: derived.values[idx]
			  }
			})

			// document.body.innerHTML = series[0].name;
			// console.log(series)
			
			Highcharts.chart('showTrend',{
			  chart: {
			      type: 'pie'
			  },
			  // plotOptions: {
			  //   pie: {
			  //     dataLabels: {
			  //       format: '{point.percentage:.1f}% <b>{point.name}</b>'
			  //     },
			  //     tooltip:{
			  //       headerFormat: '<b>{series.name}</b><br/>',
			  //       pointFormat: '{point.percentage:.1f}% {point.name}'
			  //     }
			  //   }
			  // },
			  series: [{
			    name: data.metadata.y_axis_title,
			    data: series
			  }]
			});
		});


		// var ajax = function(url, callback, data){
		// 	var xhr = new XMLHttpRequest();

		// 	xhr.open(data ? 'POST' : 'GET', url, true);

		// 	xhr.send();
		// 	xhr.onreadystatechange = function(){
		// 		if (this.readyState == 4 && this.status == 200) {
		// 	       callback(JSON.parse(xhr.responseText));
		// 	    }
		// 	}
		// };
		// var apiUrl = 'https://api.pensionangel.com:5000/api/v1.0';
		// var absoluteUrl = location.origin; //"http://localhost:3000/pages";

		// window.Store = {
		// 	showTrend: function(callback){
		// 	  return ajax(apiUrl + '/show_trend', callback);
		// 	}
		// }

		// Store.showTrend(function(data) {
		// 	// console.log(data);
		// 	var derived = Helpers.derive(data);
			
		// 	var series = derived.labels.map(function(label, idx){
		// 	  return {
		// 	    name: label,
		// 	    color: label == ' of funds are worth more than a year ago' ? '#619445': '#C94545',
		// 	    y: derived.values[idx]
		// 	  }
		// 	})

		// 	Highcharts.chart('showTrend', Highcharts.merge({
		// 	  chart: {
		// 	      type: 'pie'
		// 	  },
		// 	  plotOptions: {
		// 	    pie: {
		// 	      dataLabels: {
		// 	        format: '{point.percentage:.1f}% <b>{point.name}</b>'
		// 	      },
		// 	      tooltip:{
		// 	        headerFormat: '<b>{series.name}</b><br/>',
		// 	        pointFormat: '{point.percentage:.1f}% {point.name}'
		// 	      }
		// 	    }
		// 	  },
		// 	  series: [{
		// 	    name: data.metadata.y_axis_title,
		// 	    data: series
		// 	  }]
		// 	}));
		// })
		// Store.showTrend().then(function(data){
		//   // Â Â alert(data)
		  
		// })
	});

</script>

<script>
</script>


</body>
</html>
<!-- partial -->
